<!--
 @author  Qianbw
 @create 2020-03-19 18:31
-->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <title>题库管理</title>
    <link rel="stylesheet" th:href="@{../static/lib/layui/css/layui.css}">
    <script th:src="@{../static/lib/layui/layui.js}"></script>
    <script type="text/javascript" th:src="@{../static/js/xadmin.js}"></script>
    <link rel="stylesheet" th:href="@{../css/xadmin.css}">
</head>
<body>
<input type="hidden" th:value="${homeworkid}" id="homeworkid" />
<input type="hidden" th:value="${courseid}" id="courseid" />
<input type="hidden" th:value="${homeworkName}" id="homeworkName" />
<input type="hidden" id="count" />
<div class="layui-fluid">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md12">
            <div class="layui-card">
                <div class="layui-card-body ">
                    <table id="table" lay-filter="demo" class="layui-table layui-form">
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>


<script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-xs" lay-event="doQuestion">做题</a>
</script>

<script>
    var $;
    var laydate;
    var layer;
    var form;
    var table;
    var layedit;
    layui.use([ 'layer', 'form', 'laydate', 'jquery', 'table', 'layedit' ],
        function() {
            layer = layui.layer;
            form = layui.form;
            laydate = layui.laydate;
            $ = layui.jquery;
            table = layui.table;
            layedit = layui.layedit;
            query();
            optionTool();//监听工具条


        });

    function query() {
        // 执行渲染
        table.render({
            elem : '#table', // 指定原始表格元素选择器（推荐id选择器）
            url : '/student/selectQuestionFromHomeworkID' ,
            id : 'questionid', // 设定容器唯一ID
            page : true, // 是否开启分页
            loading : true, // 是否显示加载条
            height : 550, // 容器高度,
            page: 1,
            limit: 10,
            method: 'post',
            //,where: {token: 'sasasas', id: 123} //如果无需传递额外参数，可不加该参数
            //,method: 'post' //如果无需自定义HTTP类型，可不加该参数
            //,request: {} //如果无需自定义请求参数，可不加该参数
            //,response: {} //如果无需自定义数据响应名称，可不加该参数
            where: {
                'homeworkid' : $("#homeworkid").val(),
                page: this.page,
                limit: this.limit,
            },
            cols : [ [ // 标题栏
                {
                    field : 'questionNumber',
                    title : '题目序号',
                    align : 'center',
                    sort : true,
                    minWidth: '150'
                }, {
                    field : 'title',
                    title : '题目名称',
                    align : 'center',
                    width: '150'
                }, {
                    field : 'description',
                    title : '题目描述',
                    align : 'center',
                    minWidth: '300'
                }, {
                    field : 'questiontype',
                    title : '题目类型',
                    align : 'center',
                    width: '200'
                }, {
                    fixed : 'right',
                    title :'操作',
                    toolbar : '#barDemo',
                    align : 'center',
                    width : '150'
                }
                // colspan即横跨的单元格数，这种情况下不用设置field和width
            ]], // 设置表头
            done : function(res, curr, count) {
                console.log(res);
                // 得到当前页码
                console.log(curr);
                // 得到数据总量
                console.log(count);
                $("#count").val(count);
            }
        });

    };

    function optionTool() {
        table.on('tool(demo)', function(obj){
            var data = obj.data;
            if(obj.event === 'doQuestion'){//题目
                parent.parent.parent.xadmin.open($("#homeworkName").val() ,'/studentCourse/toDoQuestion?homeworkid='
                    +$("#homeworkid").val()+
                    '&questionnumber='+data.questionNumber+
                    '&courseid='+$("#courseid").val()+
                    '&count='+$("#count").val());
            }
        });
    }

</script>

